# -*- shell-script -*-

# Basic stuff.

alias ls='ls --color=auto'
alias cp='cp -v'
alias gmc='gmc --nodesktop'
alias df='df -h'
alias mv='mv -v'
alias xboard='xboard -size Bulky'
alias mpg321='mpg321 -v '
# function works better because args are passed
# to du rather than less
#alias du='du * | sort -gr | less'
function du() {
  env du * "$@" | sort -gr | less
}

alias crontab='EDITOR=vim crontab'
#alias glxgears='glxgears -printfps'
alias k9='kill -9 $$'
alias sqlite='sqlite3'
alias callgrind='valgrind --tool=callgrind'
alias mc="LANG=en_US mc"
VLC=""
if test -f /usr/bin/vlc; then
  VLC=/usr/bin/vlc
elif test -f /snap/bin/vlc; then
  VLC=/snap/bin/vlc
fi

if test ! -z "$VLC"; then
  alias vlc="${VLC} --key-jump+medium \"Mouse Wheel Down\" --key-jump-medium \"Mouse Wheel Up\""
fi
alias path="echo \$PATH"
if which visual-studio-code &> /dev/null; then
  alias code="visual-studio-code"
elif which vscode &> /dev/null; then
  alias code="vscode"
elif which vscodium &> /dev/null; then
  alias code="vscodium"
fi
alias nethogs='sudo -p "Your password is required to continue:" /usr/bin/nethogs'
# make eix search everything
alias eix='eix -y'
alias dlr='wget --no-parent --continue --user "${WGET_USER}" --password "${WGET_PASS}" -r'
alias ss='select-sound-output'
alias ssa='echo a | ss'
alias ssb='echo b | ss'
alias ssc='echo c | ss'
alias lg='lazygit'
alias r2modman='r2modman --no-sandbox'
alias apt='auto-sudo-apt'
alias update-grub='auto-sudo update-grub'
alias webstorm='run-jetbrains-product webstorm'
alias rider='run-jetbrains-product rider'
alias datagrip='run-jetbrains-product datagrip'
alias android-studio='run-jetbrains-product studio'
alias pycharm='run-jetbrains-product pycharm'
alias release-pull-request='npx -y release-pull-request'
alias history='history 0'
alias which-branch-owns='git branch -a --contains'

case "$XDG_SESSION_TYPE" in
  "x11")
    alias clip="xclip"
    ;;
  "wayland")
    alias clip="wl-copy"
    ;;
  *)
    # no clip for tty or any other unknown value
    ;;
esac
alias check-git="scan-git ~/code/codeo ~/code/opensource --ignore git-broadcast --ignore PeanutButter.TrayIcon --ignore detached-point-arithmetic --ignore phoenix.upgrade --ignore convert-type-imports --ignore newts"
alias elevate-firefox="renice-all firefox -17"
alias start="xdg-open"

function npm() {
  SEARCH=$(pwd)
  NPM=$(/usr/bin/which npm)
  while test "$SEARCH" != "/"; do
    LOCKFILE="$SEARCH/pnpm-lock.yaml"
    if test -f "$LOCKFILE"; then
      NPM=$(/usr/bin/which pnpm)
      echo "using pnpm - lock found at: $LOCKFILE"
      break;
    fi
    if test -f "$SEARCH/package-lock.json"; then
      break;
    fi
    SEARCH=$(dirname "$SEARCH")
  done
  $NPM $*
}

